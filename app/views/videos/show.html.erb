<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
  rel="stylesheet">
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
  rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<style>
  .navbar {
            background-color: black;
            padding: 0.7rem 1rem;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .navbar-brand img {
            height: 24px;
        }

        .input-group {
            width: 650px;
            height: 40px;
            border: 1px solid #303030;
            border-radius: 20px 0 0 20px;
            overflow: hidden;
        }

        .input-group .form-control {
            background-color: #121212;
            color: #fff;
            border: none;
            padding: 0 12px;
            font-size: 16px;
            line-height: 1.5;
            height: 40px;
        }

        .input-group .form-control::placeholder {
            color: #aaa;
            font-size: 16px;
        }

        .input-group .form-control:focus {
            outline: none;
            box-shadow: none;
        }

        .input-group button {
            background-color: #303030;
            color: white;
            border: none;
            border-radius: 0 20px 20px 0;
            width: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 40px;
        }

        .input-group button:hover {
            background-color: #303030;
            color: white;
        }

        .input-group button i {
            font-size: 22px;
        }

        .btn-mic {
            background-color: #202020;
            color: white;
            border: none;
            margin-left: 10px;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-mic i {
            font-size: 22px;
        }

        .btn-mic:hover {
            color: white;
            background-color: #303030;
        }

        .navbar .nav-link {
            color: white;
            margin-right: 15px;
            font-size: 20px;
        }

        .navbar .nav-link i {
            font-size: 24px;
        }

        .nav-item img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
        }

        .dropdown-menu {
            background-color: #282828;
            border: none;
            color: white;
            width: 320px;
            border-radius: 6px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }

        .dropdown-item {
            color: white;
            font-size: 16px;
        }

        .dropdown-item:hover {
            color: white;
            background-color: #383838;
        }

        .dropdown-item i {
            font-size: 20px;
            margin-right: 10px;
        }

        .dropdown-toggle::after {
            display: none !important;
        }

        .dropdown-header {
            padding: 16px;
            color: white;
            display: flex;
            align-items: center;
        }

        .dropdown-header img {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            margin-right: 10px;
            margin-top: -10px;
        }

        .dropdown-header a {
            color: #1d9bf0;
            text-decoration: none;
            font-size: 14px;
        }

        .dropdown-header a:hover {
            text-decoration: underline;
        }

        .dropdown-header h6 {
            margin-bottom: 5px;
            font-size: 16px;
        }

        .dropdown-header p {
            margin-bottom: 0;
            font-size: 12px;
        }

        .dropdown-divider {
            margin: 10px 0;
            border-top: 1px solid white;
        }

        .dropdown-item.extra-item {
            font-size: 14px;
        }

        .dropdown-item.extra-item:hover {
            background-color: #444;
        }
  body {
    background-color: white;
  }

  .video-container {
    background-color: white;
    border-radius: 6px;
    margin-bottom: 20px;
  }

  .video-container h2 {
    font-size: 1.5rem;
    margin-top: 10px;
  }

  .video-container p {
    color: #606060;
    font-size: 0.9rem;
    margin-bottom: 15px;
  }

  .channel-section {
    display: flex;
    align-items: center;
    margin-top: 15px;
    padding-top: 15px;
  }

  .channel-section img {
    border-radius: 50%;
    width: 50px;
    height: 50px;
  }

  .channel-section h5 {
    margin-bottom: 0;
    font-size: 1rem;
  }

  .channel-section button {
    margin-left: auto;
    font-weight: bold;
    padding: 6px 12px;
    font-size: 0.9rem;
  }

  .up-next {
    margin-top: 20px;
  }

  .up-next h5 {
    font-size: 1.2rem;
    color: #212529;
  }

  .up-next .video-item {
    display: flex;
    align-items: flex-start;
    margin-bottom: 15px;
  }

  .up-next .video-preview {
    width: 170px;
    height: 100px;
    object-fit: cover;
    border-radius: 6px;
    margin-right: 10px;
  }

  .up-next .video-title {
    font-size: 0.95rem;
    font-weight: bold;
    color: #212529;
    text-decoration: none;
    margin: 0;
    line-height: 1.3;
  }
  .up-next .video-meta {
    color: #606060;
    font-size: 0.85rem;
    margin-top: 5px;
  }

  .comment-section {
    margin-top: 24px;
    background-color: white;
    padding: 16px;
    border-radius: 6px;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
  }

  .comment-section h4 {
    font-size: 1.2rem;
    margin-bottom: 10px;
  }

  .add-comment textarea {
    width: 100%;
    resize: none;
    border-radius: 4px;
    padding: 10px;
    margin-top: 10px;
    font-size: 0.95rem;
  }

  .add-comment button {
    margin-top: 10px;
    float: right;
    padding: 6px 12px;
  }

  .comment {
    display: flex;
    margin-top: 15px;
  }

  .comment img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    margin-right: 10px;
  }

  .comment h6 {
    font-size: 0.9rem;
    margin-bottom: 5px;
  }

  .comment p {
    font-size: 0.9rem;
    color: #212529;
    margin-bottom: 0;
  }
  .video-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 12px;
            border-bottom: 1px solid rgb(229, 229, 229);
        }
        .views-date {
            display: flex;
            gap: 4px;
            color: var(--Dark-Primary);
            opacity: 0.7;
            font-size: 14px;
        }
        .engagement-buttons {
            display: flex;
            gap: 5px;
        }

        .engage-button {
            display: flex;
            align-items: center;
            gap: 6px;
            background: none;
            border: none;
            padding: 8px;
            cursor: pointer;
            font-weight: 500;
        }

        .video-description {
            background: rgb(229, 229, 229);
            padding: 12px;
            border-radius: 2px;
            margin: 16px 0;
        }
        .description-text {
            font-size: 14px;
            white-space: pre-wrap;
        }
        .show-more-button {
            background: none;
            border: none;
            color: var(--Dark-Primary);
            font-weight: 500;
            cursor: pointer;
            padding: 8px 0;
        }
        .comments-section {
            margin-top: 24px;
        }
        .comments-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        .comments-count {
            font-size: 16px;
            font-weight: 500;
        }
        .sort-button {
            display: flex;
            align-items: center;
            gap: 8px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
        }
        .comment-form {
            display: flex;
            gap: 16px;
            margin-bottom: 32px;
        }
        .channel-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
        }
        .comment-input {
            flex: 1;
            border: none;
            width: 100%;
            border-bottom: 1px solid rgb(229, 229, 229);
            padding: 8px 0;
            font-size: 14px;
            resize: none;
        }

        .comment-input:focus {
            outline: none;
            border-color:1px solid rgb(229, 229, 229);
        }
        .comment-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 8px;
        }
        .comment-button {
            padding: 8px 16px;
            border: none;
            border-radius: 2px;
            font-weight: 500;
            cursor: pointer;
        }
        .cancel-button {
            background: none;
            font-size: 14px;
        }

        .submit-button {
            background: var(--Light-Quaternary);
            color: var(--Dark-Primary);
        }

        .submit-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .comment-input-wrapper {
          flex: 1;
        }


        .comment-actions.left-aligned {
          justify-content: flex-start;
        }

.cancel-button {
  background: none;
}

.submit-button {
  background: var(--Light-Quaternary);
  color: var(--Dark-Primary);
}

.submit-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
.filter-tags-wrapper {
  display: flex;
  align-items: center;
  gap: 8px;
  overflow: hidden;
  position: relative;
}

.filter-tags {
  display: flex;
  gap: 16px;
  overflow-x: auto;
  scroll-behavior: smooth;
  flex-wrap: nowrap;
  white-space: nowrap;
  margin: 0;
}

.filter-tags::-webkit-scrollbar {
  display: none; 
}

.tag {
  border-radius: 10px;
  padding: 8px 12px;
  font: 500 14px Roboto, sans-serif;
  color: #000;
  border: 1px solid rgba(0, 0, 0, 0.22);
  background: rgba(0, 0, 0, 0.02);
  cursor: pointer;
  white-space: nowrap;
}

.tag.active {
  background: #000;
  color: #fff;
  border-color: #000;
}

.scroll-btn {
  background: #fff;
  border: none;
  font-size: 20px;
  cursor: pointer;
  padding: 4px 12px;
  border-radius: 50%;
  z-index: 10;
}

.scroll-btn:hover {
  background: #f0f0f0;
}

.left-button{
  left: 8px;
}

.right-button {
  right: 8px;
}

</style>
<body>
  <div class="container-fluid mt-4">
    <div class="row">
      <div class="col-md-8">
        <div class="video-container">
          <% if @video.file.attached? %>
          <div class="ratio ratio-16x9">
            <video controls>
              <source src="<%= url_for(@video.file) %>" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
          <% else %>
          <div class="alert alert-warning mt-3">No video available.</div>
          <% end %>

          <h2><%= @video.title %></h2>
          <div class="video-stats">
            <div class="views-date">
              <span><%= @video.watch_counts.count %> views</span>
              <span>•</span>
              <span><%= time_ago_in_words(@video.created_at) %> ago</span>
            </div>

            <div class="engagement-buttons">
              <%= button_to video_likes_path(@video),
              method: :post,
              class: "engage-button",
              data: { disable_with: "Processing..." },
              aria: { label: "Like" } do %>
              <svg width="24" height="24" viewBox="0 0 24 24"
                fill="currentColor">
                <path
                  d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-1.91l-.01-.01L23 10z" />
              </svg>
              <span><%= number_to_human(@video.likes.count, format: '%n%u',
                units: { thousand: 'K' }) %></span>
              <% end %>

              <%= button_to video_like_path(@video),
              method: :delete,
              class: "engage-button",
              data: { disable_with: "Processing..." },
              aria: { label: "Dislike" } do %>
              <svg width="24" height="24" viewBox="0 0 24 24"
                fill="currentColor">
                <path
                  d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v1.91l.01.01L1 14c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z" />
              </svg>
              <% end %>

              <button class="engage-button" aria-label="Share">
                <svg width="24" height="24" viewBox="0 0 24 24"
                  fill="currentColor">
                  <path
                    d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z" />
                </svg>
                <span>SHARE</span>
              </button>
              <button class="engage-button" aria-label="Download">
                <svg width="24" height="24" viewBox="0 0 24 24"
                  fill="currentColor">
                  <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" />
                </svg>
                <span>DOWNLOAD</span>
              </button>
            </div>
          </div>

          <div class="channel-section">
            <img src="https://img6.arthub.ai/64c007f4-aa90.webp"
              alt="Channel Avatar">
            <div class="ms-3">
              <h5>FC Barcelona</h5>
              <small class="text-muted">14.1M subscribers</small>
            </div>
            <button class="btn btn-danger btn-sm">Subscribe</button>
          </div>

          <div class="video-description">
            <p class="description-text"><%= @video.description %></p>
            <button class="show-more-button">SHOW MORE</button>
          </div>
          <div class="comments-section">
            <div class="comments-header">
              <span class="comments-count">
                <%= pluralize(@video.comments.count, "Comment") %>
              </span>
              <button class="sort-button">
                <svg width="24" height="24" viewBox="0 0 24 24"
                  fill="currentColor">
                  <path d="M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z" />
                </svg>
                SORT BY
              </button>
            </div>

            <div class="comment-form">
              <img src="https://img6.arthub.ai/64c007f4-aa90.webp" alt
                class="channel-avatar">
              <div class="comment-input-wrapper">
                <%= form_with(model: [@video, @video.comments.build], local:
                true, html: { class: 'comment-form-rails' }) do |form| %>
                <%= form.text_area :content, placeholder: "Add a comment...",
                class: "comment-input", rows: 1 %>
                <div class="comment-actions">
                  <button type="button" class="comment-button cancel-button"
                    onclick="this.form.reset()">CANCEL</button>
                  <%= form.submit "Comment", class:
                  "comment-button submit-button" %>
                </div>
                <% end %>
              </div>
            </div>

            <% @video.comments.each do |comment| %>
            <div class="comment mt-4">
              <img src="https://img6.arthub.ai/64c007f4-aa90.webp"
                alt="User Avatar" class="channel-avatar">
              <div>
                <h6>User Name</h6>
                <% if comment.created_at.present? %>
                <small class="text-muted"><%=
                  time_ago_in_words(comment.created_at) %> ago</small>
                <% else %>
                <small class="text-muted">Unknown time</small>
                <% end %>
                <p><%= comment.content %></p>
              </div>
            </div>
            <% end %>
          </div>

        </div>

      </div>
      <div class="col-md-4">
        <div class="container-fluid">
          <div class="filter-tags-wrapper">
            <button class="scroll-btn left-button" aria-label="Scroll Left"><i
                class="fas fa-chevron-left"></i></button>
            <div class="filter-tags" role="navigation"
              aria-label="Content filters">
              <button class="tag active" aria-pressed="true">All</button>
              <button class="tag">Gaming</button>
              <button class="tag">FC Barcelona</button>
              <button class="tag">Apple</button>
              <button class="tag">Sports leagues</button>
              <button class="tag">User interface design</button>
              <button class="tag">Music</button>
              <button class="tag">Mixes</button>
              <button class="tag">Live</button>
              <button class="tag">EFootball</button>
              <button class="tag">Editing</button>
              <button class="tag">Game shows</button>
              <button class="tag">Intelligence</button>
              <button class="tag">Academic Conference</button>
              <button class="tag">Artificial Intelligence</button>
              <button class="tag">Education</button>
            </div>
            <button class="scroll-btn right-button"
              aria-label="Scroll Right"><i
                class="fas fa-chevron-right"></i></button>

          </div>
        </div>
        <div class="up-next">
          <% @videos.each do |video| %>
          <div class="video-item">
            <video class="video-preview" muted>
              <source src="<%= url_for(video.file) %>" type="video/mp4">
              Your browser does not support the video tag.
            </video>
            <div>
              <a href="<%= video_path(video) %>" class="video-title"><%=
                video.title %></a>
              <div class="video-meta">
                Channel Name<br>
                <%= @video.watch_counts.count %> views • <%=
                time_ago_in_words(video.created_at) %> ago
              </div>
            </div>
          </div>
          <% end %>
        </div>
      </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
        const filterTags = document.querySelector(".filter-tags");
        const leftBtn = document.querySelector(".left-button");
        const rightBtn = document.querySelector(".right-button");

        function updateButtonVisibility() {
            const scrollLeft = filterTags.scrollLeft;
            const scrollWidth = filterTags.scrollWidth;
            const clientWidth = filterTags.clientWidth;

            if (scrollLeft <= 0) {
                leftBtn.style.display = 'none';
            } else {
                leftBtn.style.display = 'block';
            }

            if (scrollLeft + clientWidth >= scrollWidth) {
                rightBtn.style.display = 'none';
            } else {
                rightBtn.style.display = 'block';
            }
        }

        updateButtonVisibility();

        leftBtn.addEventListener("click", () => {
            filterTags.scrollBy({ left: -200, behavior: "smooth" });
            updateButtonVisibility();  
        });

        rightBtn.addEventListener("click", () => {
            filterTags.scrollBy({ left: 200, behavior: "smooth" });
            updateButtonVisibility();  
        });

        filterTags.addEventListener('scroll', updateButtonVisibility);

        const tags = document.querySelectorAll(".tag");
        tags.forEach((tag) => {
            tag.addEventListener("click", () => {
                tags.forEach((t) => t.classList.remove("active")); 
                tag.classList.add("active"); 
            });
        });
    });
  </script>
  </body>
